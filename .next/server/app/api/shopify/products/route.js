"use strict";(()=>{var t={};t.id=630,t.ids=[630],t.modules={399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1779:(t,e,r)=>{r.r(e),r.d(e,{originalPathname:()=>y,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var o={};r.r(o),r.d(o,{GET:()=>c,dynamic:()=>p});var s=r(9303),a=r(8716),n=r(670),i=r(7070);let p="force-dynamic",u=process.env.SHOPIFY_ACCESS_TOKEN;async function c(t){try{if(!u)return i.NextResponse.json({error:"Shopify non configur\xe9"},{status:500});let e=t.nextUrl.searchParams.get("limit")||"50",r=await fetch(`https://f24081-64.myshopify.com/admin/api/2024-01/products.json?limit=${e}`,{headers:{"X-Shopify-Access-Token":u,"Content-Type":"application/json"}});if(!r.ok){let t=await r.text();return i.NextResponse.json({error:"Erreur Shopify",details:t},{status:r.status})}let o=(await r.json()).products||[],s=o.map(t=>({id:t.id,title:t.title,status:t.status,productType:t.product_type,vendor:t.vendor,variants:t.variants?.length||0,totalInventory:t.variants?.reduce((t,e)=>t+(e.inventory_quantity||0),0)||0,priceRange:{min:Math.min(...t.variants?.map(t=>parseFloat(t.price)||0)||[0]),max:Math.max(...t.variants?.map(t=>parseFloat(t.price)||0)||[0])}})),a=s.filter(t=>t.totalInventory<=5&&t.totalInventory>0),n=s.filter(t=>0===t.totalInventory);return i.NextResponse.json({success:!0,metrics:{totalProducts:o.length,activeProducts:o.filter(t=>"active"===t.status).length,lowStockCount:a.length,outOfStockCount:n.length},lowStock:a,outOfStock:n,products:s.slice(0,20)})}catch(t){return console.error("Shopify Products API Error:",t),i.NextResponse.json({error:"Erreur serveur"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/shopify/products/route",pathname:"/api/shopify/products",filename:"route",bundlePath:"app/api/shopify/products/route"},resolvedPagePath:"/Users/alektkt/Documents/weedn-project/weedn-command-center/src/app/api/shopify/products/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=d,y="/api/shopify/products/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var e=require("../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),o=e.X(0,[948,972],()=>r(1779));module.exports=o})();