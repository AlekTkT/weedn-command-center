"use strict";(()=>{var e={};e.id=761,e.ids=[761],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4363:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>m,requestAsyncStorage:()=>f,routeModule:()=>l,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var o={};r.r(o),r.d(o,{GET:()=>d,POST:()=>u});var i=r(9303),s=r(8716),n=r(670),p=r(7070);let a=process.env.SHOPIFY_ACCESS_TOKEN,c="f24081-64.myshopify.com";async function u(e){try{let{action:t,productId:r,data:o,requireApproval:i=!0}=await e.json();if(!a)return p.NextResponse.json({error:"Shopify non configur\xe9"},{status:500});if(!t)return p.NextResponse.json({error:"Action requise"},{status:400});if(["get_product","list_products","check_inventory"].includes(t)){if("get_product"===t&&r){let e=await fetch(`https://${c}/admin/api/2024-01/products/${r}.json`,{headers:{"X-Shopify-Access-Token":a,"Content-Type":"application/json"}}),t=await e.json();return p.NextResponse.json({success:!0,product:t.product})}if("check_inventory"===t){let e=await fetch(`https://${c}/admin/api/2024-01/products.json?limit=50`,{headers:{"X-Shopify-Access-Token":a,"Content-Type":"application/json"}}),t=await e.json(),r=t.products?.map(e=>({id:e.id,title:e.title,totalStock:e.variants?.reduce((e,t)=>e+(t.inventory_quantity||0),0),status:e.status}));return p.NextResponse.json({success:!0,inventory:r})}}let s={id:`action_${Date.now()}`,type:"shopify_product",action:t,params:{productId:r,data:o},status:i?"pending_approval":"pending_execution",createdAt:new Date().toISOString()};return p.NextResponse.json({success:!0,message:i?"Modification en attente d'approbation":"Modification programm\xe9e",actionRequest:s})}catch(e){return console.error("Shopify action error:",e),p.NextResponse.json({error:"Erreur serveur"},{status:500})}}async function d(){return p.NextResponse.json({availableActions:[{action:"get_product",description:"R\xe9cup\xe9rer un produit",requiresApproval:!1},{action:"list_products",description:"Lister les produits",requiresApproval:!1},{action:"check_inventory",description:"V\xe9rifier les stocks",requiresApproval:!1},{action:"update_product",description:"Modifier un produit",requiresApproval:!0},{action:"update_price",description:"Modifier un prix",requiresApproval:!0},{action:"update_inventory",description:"Modifier le stock",requiresApproval:!0}]})}let l=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/actions/shopify/product/route",pathname:"/api/actions/shopify/product",filename:"route",bundlePath:"app/api/actions/shopify/product/route"},resolvedPagePath:"/Users/alektkt/Documents/weedn-project/weedn-command-center/src/app/api/actions/shopify/product/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:y}=l,v="/api/actions/shopify/product/route";function m(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948,972],()=>r(4363));module.exports=o})();